{% extends "sitewide/flat_ui_template.html" %}{% load static %}
{% load custom_tags %}

{% block title %}Debug Tilt{% endblock %}

{% block content %}

    <h1>Debugging Tilt Support</h1>


    <h3>System Packages</h3>

    <p>
        Fermentrack relies on several applications being installed on the system at the same time as Fermentrack. If any
        of these packages are missing, it can impact the necessary Python packages from being installed or functioning
        as expected.
    </p>

    {% if has_apt %}
        {% if has_apt_packages %}
            <h4>All necessary system packages are installed</h4>
        {% else %}
            <h4 style="color: darkred">Several system packages are missing. </h4>
        {% endif %}{# has_apt_packages #}

        <table class="table table-hover">
            <tr>
                <td>Package Name</td>
                <td>OK?</td>
            </tr>

            {% for test_result in apt_test_results %}
                <tr>
                    <td>{{ test_result.package }}</td>
                    <td>{% if test_result.result %}Installed{% else %}Not Installed{% endif %}</td>
                </tr>
            {% endfor %}

        </table>
    {% else %}
            <h4>Unable to locate the software necessary to check system packages</h4>
            <p>
                This test only works for systems that use apt/dpkg, like Raspbian, Debian, or Ubuntu. If you are running
                on another operating system, you're unfortunately on your own for this test.
            </p>
    {% endif %}{# has_apt #}


    <h3>Python Packages</h3>

    <p>
    Fermentrack is a Python-based application, and requires a number of Python packages to be installed and at the
    correct version in order for all of its features to work. That said - it is designed to fail (somewhat) gracefully,
    and as such if certain packages are missing only those features that rely on those packages (e.g. Tilt support) will
    stop working. This test checks to ensure that all packages required for Tilt support are installed and at the
    required version.
    </p>

    <p>
    {# TODO - Make this actually test the OS and hide the message for MacOS and Linux #}
    <b>Note - </b> The package list being tested below does not apply to installations on Windows.
    </p>

    {% if has_python_packages %}
        <h4>All necessary python packages are installed</h4>
    {% else %}
        <h4 style="color: darkred">Several python packages are missing. </h4>
    {% endif %}{# has_python_packages #}


    <table class="table table-hover">
        <tr>
            <td>Package Name</td>
            <td>Required Version</td>
            <td>Installed Version</td>
            <td>OK?</td>
        </tr>

        {% for test_result in python_test_results %}
        <tr>
            <td>{{ test_result.package }}</td>
            <td>{{ test_result.required_version }}</td>
            <td>{{ test_result.installed_version }}</td>
            <td>{% if test_result.ok %}OK{% else %}Not OK{% endif %}</td>
        </tr>
        {% endfor %}
    </table>


{% endblock %}


{% block scripts %}
{% endblock %}





